<!DOCTYPE html>
<html>
  <head>
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="../stylesheets/core.css" media="screen">
    <link rel="stylesheet" href="../stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)">

    <script data-ad-client="ca-pub-4602280977756527" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>



    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-storage.js"></script>

    <script src="../firebaseConfig.js"></script>

    <title>PC Builder</title>
    
  </head>

  <body>

    <div class="header">
    <h1 id="title_pages">~~~ PC-Builder.ca ~~~</h1>
    </div>
    
    
    
    


    <div>
        
      <p id="no_listings" style="position: fixed;margin-top: 10vh;width: 100%;text-align: center;">
        Loading...
          
        <div>
          <p style="color:darkred;font: 3.5em 'Raleway';text-shadow: 4px 4px white;">Click on a listing for more details...</p>
            <table class="previous_builds_table"></table>
          </div>



                <div class="div_table" style="height:8vh">
                <table class="previousbuilds_page_table">
                  <th><a href="home.html">Home</a></th><th><a href="products.html">Products</a></th><th><a href="previousbuilds.html">Previous Builds</a></th><th><a href="contact.html">Contact Me</a></th>
                  </table>
                </div>





                <script>

                    var db = firebase.firestore();
                    var storage = firebase.storage();
                    var storageRef = storage.ref();
                    var imageURL = "";
                    var path = "";
                    var list_of_computers = "";

                    var paths = new Array();
                    var docs = new Array();

                    buildList(imageURL);
                    async function buildList(imageURL){
                    await db.collection("previous_builds").orderBy('cpu').get().then((querySnapshot) => {
                      document.getElementById("no_listings").innerHTML = "";
                        querySnapshot.forEach((doc) => {
                          path = storageRef.child('previous_builds/' + doc.id + '.JPG');
                          paths.push(path);
                          docs.push(doc);
                        });
                        getURL();
                    });
                    }

                    async function getURL(){
                      var count = paths.length;
                      for (var i = 0; i < count; i++){
                        var local_path = paths[i];
                        var local_doc = docs[i];
                        await local_path.getDownloadURL().then(async function(url){
                        list(url, local_doc);

                        }).catch(function(error) {
                        console.error(error);
                        });
                      }
                      
                    }

          
                    async function list(path, doc){
                      var pc = doc.data();
                      list_of_computers += "<button class=\"previous_builds\" data-toggle=\"collapse\" data-target=\"#info\">" + pc.cpu + "</button>" +
                                "<div id=\"info\" class=\"collapse\">" + 
                                "<div class=\"preview_image\"><img style=\"float: right;\" src=\"" + path + "\">" +
                                "<p3>" + pc.cpu + " & " + pc.gpu + "</p3></div><br>" + 
                                "<div class=\"preview_description\"><p4>CPU: " + pc.cpu + "<br>" + 

                                "<ul class=\"cpu_list\"><li>Cores: " + pc.cpu_cores + "</li><br>" + 
                                "<li>Threads: " + pc.cpu_threads + "</li><br>" + 
                                "<li>Speed: " + parseFloat(pc.cpu_speed).toFixed(1) + "GHz</li></ul>" + 

                                "GPU: " + pc.gpu + "<br>" + 
                                "RAM: " + pc.ram + "<br>" + 
                                "Motherboard: " + pc.motherboard + "<br>" + 
                                "<span id=\"extra_specs\">" +
                                "SSD: " + pc.ssd + "<br>" + 
                                "HDD: " + pc.hdd + "<br>" + 
                                "PSU: " + pc.psu + "<br>" + 
                                "WiFi: ";
                                if(pc.wifi == true){
                                  list_of_computers += "Included";
                                }
                                else{
                                  list_of_computers += "Not Included";
                                }
                                list_of_computers += "<br>" + 
                                "OS: " + pc.os + "<br>" + 
                                "</span>" +
                                //"<a href=\"\"></a>LINK: " + doc.data().cpu +
                                "</p4></div></div>";

                            document.getElementsByClassName("previous_builds_table")[0].innerHTML = list_of_computers;
                            


                            var coll = document.getElementsByClassName("previous_builds");
                            for (var i = 0; i < coll.length; i++) {
                              coll[i].addEventListener("click", function() {
                              this.classList.toggle("active");
                              var content = this.nextElementSibling;
                              if (content.style.maxHeight){
                                  content.style.maxHeight = null;
                              } else {
                                  content.style.maxHeight = content.scrollHeight + "px";
                               } 
                              });
                            }
                    }
                    






                  




                </script>
            
    
        
    </div>


  </body>
</html>
