<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="../stylesheets/core.css" media="screen">
    <link rel="stylesheet" href="../stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)">

    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-storage.js"></script>
    <script>
      var firebaseConfig = {
        apiKey: "AIzaSyDQCO5r-ICvbJe4FIKkPeq8Ayh-NT_cTqU",
        authDomain: "pc-builder-283416.firebaseapp.com",
        databaseURL: "https://pc-builder-283416.firebaseio.com",
        projectId: "pc-builder-283416",
        storageBucket: "pc-builder-283416.appspot.com",
        messagingSenderId: "521975959454",
        appId: "1:521975959454:web:f2377f67fe2adbdfc8108f",
        measurementId: "G-26MWMG7FCD"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
    </script>

    <title>PC Builder</title>
    
  </head>

  <body>

    <div class="header">
    <h1 id="title_pages">Toronto's Premium Gaming Computer Reseller</h1>
    </div>
    
    
    
    


    <div>
        
      <p id="no_listings" style="position: fixed;margin-top: 5vh;margin-left: 40%;">
        Loading...
          
            <table class="previous_builds_table">
                </table>

                <table class="table_of_contents_pages" style="margin-top:92vh;table-layout: fixed;">
                  <th><a href="about.html">About</a></th><th><a href="products.html">Products</a></th><th><a href="previousbuilds.html">Previous Builds</a></th><th><a href="contact.html">Contact Me</a></th>
                  
                  </table>

                <script>

                    var db = firebase.firestore();
                    var storage = firebase.storage();
                    var storageRef = storage.ref();
                    var imageURL = "";
                    var path = "";
                    var list_of_computers = "";

                    var paths = new Array();
                    var docs = new Array();

                    buildList(imageURL);
                    async function buildList(imageURL){
                    await db.collection("previous_builds").orderBy('cpu').get().then((querySnapshot) => {
                      document.getElementById("no_listings").innerHTML = "";
                        querySnapshot.forEach((doc) => {
                          path = storageRef.child('previous_builds/' + doc.id + '.JPG');
                          paths.push(path);
                          docs.push(doc);
                        });
                        getURL();
                    });

                    }

                    async function getURL(){
                      var count = paths.length;
                      for (var i = 0; i < count; i++){
                        var local_path = paths[i];
                        var local_doc = docs[i];
                        await local_path.getDownloadURL().then(async function(url){
                        await sendURL(url, local_doc);

                        }).catch(function(error) {
                        console.error(error);
                        });
                      }
                      
                    }

                    async function sendURL(path, doc){
                        await list(path, doc);
                    }

                    async function list(path, doc){
                      var pc = doc.data();
                      list_of_computers += "<tr><button class=\"previous_builds\" data-toggle=\"collapse\" data-target=\"#info\">" + pc.cpu + "</button>" +
                                "<div id=\"info\" class=\"collapse\">" + 
                                "<div class=\"preview_image\"><img style=\"float: right;\" src=\"" + path + "\">" +
                                "<p3>" + pc.cpu + " & " + pc.gpu + "</p3></div><br>" + 
                                "<div class=\"preview_description\"><p4>CPU: " + pc.cpu + "<br>" + 

                                "<ul class=\"cpu_list\"><li>Cores: " + pc.cpu_cores + "</li><br>" + 
                                "<li>Threads: " + pc.cpu_threads + "</li><br>" + 
                                "<li>Speed: " + parseFloat(pc.cpu_speed).toFixed(1) + "GHz</li></ul>" + 

                                "GPU: " + pc.gpu + "<br>" + 
                                "RAM: " + pc.ram + "<br>" + 
                                "Motherboard: " + pc.motherboard + "<br>" + 
                                
                                //"<a href=\"\"></a>LINK: " + doc.data().cpu +
                                "</p4></div></div></tr>";

                            document.getElementsByClassName("previous_builds_table")[0].innerHTML = list_of_computers;
                            
                            var coll = document.getElementsByClassName("previous_builds");
                            var i;
                    
                            for (i = 0; i < coll.length; i++) {
                              coll[i].addEventListener("click", function() {
                              this.classList.toggle("active");
                              var content = this.nextElementSibling;
                              if (content.style.maxHeight){
                                  content.style.maxHeight = null;
                              } else {
                                  content.style.maxHeight = content.scrollHeight + "px";
                               } 
                              });
                            }
                    }






                  




                </script>
            
    
        
    </div>


  </body>
</html>
